appId: com.lijiaxu.pngcompress
productName: PngCompress
directories:
  output: release

asar: true
compression: maximum

# 使用 afterPack hook 处理 native modules
afterPack: ./afterPack.js

# Sharp 完全解包
asarUnpack:
  - "node_modules/sharp/**"
  - "node_modules/@img/**"
  - "node_modules/**/*.node"

# GitHub Release 发布配置
publish:
  provider: github
  owner: lijiaxu
  repo: pngCompress
  releaseType: release

files:
  - dist/**/*
  - dist-main/**/*
  - package.json
  - "node_modules/**/*"
  - "!**/*.{ts,tsx,map,md}"
  - "!**/node_modules/**/*.md"
  - "!**/node_modules/**/test/**"
  - "!**/node_modules/**/tests/**"
  - "!**/node_modules/**/docs/**"
  - "!**/node_modules/**/.github/**"

mac:
  target:
    - target: dmg
      arch:
        - x64
        - arm64
    - target: zip
      arch:
        - x64
        - arm64
  category: public.app-category.developer-tools
  electronLanguages:
    - en
    - zh_CN

win:
  target:
    - target: nsis
      arch: x64
    - target: zip
      arch: x64
  icon: resources/icon.ico

nsis:
  oneClick: false
  allowToChangeInstallationDirectory: true

dmg:
  writeUpdateInfo: false
